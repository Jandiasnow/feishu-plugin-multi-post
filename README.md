# 飞书多维表格批量提交请求插件

## 功能特点

1. 支持多种请求方式：
   - 单条请求：逐行发送数据，可设置请求间隔
   - 数组请求：将所有数据组装成数组一次性发送

2. 灵活的配置管理：
   - 支持导入/导出配置文件（JSON格式）
   - 可保存配置到本地存储
   - 支持多个 API 配置同时存在

3. 丰富的请求配置：
   - 自定义请求头
   - 灵活的请求体配置
   - 支持多种数据类型（字符串、数字、布尔值、对象、数组）
   - 支持从表格字段关联或手动输入

4. 响应数据处理：
   - 支持响应数据字段映射到表格
   - 支持 JavaScript 代码处理响应数据
   - 失败请求详细记录
   - 实时进度显示

## 项目结构

```
.
├── src/                      # 源代码目录
│   ├── index.tsx            # 入口文件
│   └──  multi-post.tsx       # API 请求主组件
├── public/                   # 静态资源目录
├── dist/                    # 构建输出目录
├── index.html               # HTML 入口文件
├── package.json             # 项目依赖配置
├── tsconfig.json            # TypeScript 配置
├── tsconfig.node.json       # Node.js TypeScript 配置
├── vite.config.js           # Vite 构建配置
├── vercel.json             # Vercel 部署配置
└── README.md               # 项目文档
```

## 环境要求
- Node.js 20+
- yarn

## 安装步骤

1. 安装 yarn（如果未安装）：
```bash
npm install -g yarn
```

2. 安装依赖：
```bash
yarn
```

3. 启动开发服务器：
```bash
yarn run start
```

4. 在控制台查看输出的 URL，点击打开页面并复制 URL

## 使用说明

### 基本配置
1. 设置处理范围：指定要处理的起始行和结束行
2. 添加 API 配置：点击"添加"按钮创建新的 API 配置
3. 配置 API 信息：
   - 名称：配置的标识名称
   - API 地址：请求的目标地址
   - 失败代码：指定哪些响应代码表示失败
   - 请求方式：选择单条请求或数组请求

### 请求方式说明
1. 单条请求：
   - 逐行发送数据
   - 可设置请求间隔（毫秒）
   - 适合需要控制请求频率的场景

2. 数组请求：
   - 将所有数据组装成数组一次性发送
   - 无需设置请求间隔
   - 适合服务端支持批量处理的场景
   - 服务端需要能处理数组格式的请求体
   - 期望服务端返回数组格式的响应

### 数据映射
1. 请求头配置：
   - 支持手动输入或从表格字段关联
   - 可通过 JSON 导入批量配置

2. 请求体配置：
   - 支持多种数据类型
   - 可从表格字段关联或手动输入
   - 支持数组类型的字段配置
   - 可通过 JSON 导入批量配置

3. 响应数据映射：
   - 配置响应数据字段到表格字段的映射关系
   - 支持 JavaScript 代码处理响应数据
   - 支持嵌套字段路径（使用点号分隔）

### 配置管理
- 导出配置：将当前所有 API 配置导出为 JSON 文件
- 导入配置：从 JSON 文件导入 API 配置
- 保存配置：将当前配置保存到浏览器本地存储

### 错误处理
- 详细的失败记录
- 可查看每个失败请求的具体响应数据
- 统计成功和失败的请求数量

## 注意事项
1. 数组请求模式下，服务端需要支持处理数组格式的请求体
2. 服务端返回的响应应与请求数据数量对应
3. 建议在处理大量数据前先进行小范围测试
4. 定期导出配置文件作为备份

## 开发相关

### 技术栈
- React + TypeScript
- Ant Design 组件库
- Vite 构建工具
- 飞书多维表格 SDK

### 构建和部署
- 开发环境：`yarn start`
- 构建生产版本：`yarn build`
- 支持 Vercel 自动部署